# Инструкция по установке и запуску сайта доставки по Беларуси

## Требования
- XAMPP (PHP 7.4+ и MySQL)
- Доступ к интернету для работы с API OpenStreetMap

## Установка

### 1. Установка XAMPP
1. Скачайте и установите XAMPP с официального сайта: https://www.apachefriends.org/
2. Запустите XAMPP Control Panel
3. Запустите Apache и MySQL

### 2. Размещение файлов
1. Скопируйте все файлы проекта в папку `htdocs` в директории XAMPP
2. Убедитесь, что файлы находятся в подпапке, например: `htdocs/delivery-by`

### 3. Настройка базы данных
1. Откройте phpMyAdmin в браузере (обычно http://localhost/phpmyadmin)
2. Создайте новую базу данных с именем `delivery_db`
3. Импортируйте SQL-файл `db.sql` в созданную базу данных

### 4. Запуск приложения
1. Откройте браузер и перейдите по адресу http://localhost/delivery-by
2. Приложение должно запуститься и работать

## Структура проекта

```
delivery-by/
├── index.php           # Главная страница (калькулятор доставки)
├── order_form.php      # Форма оформления заказа
├── create_order.php    # Обработка создания заказа
├── order_success.php   # Страница успешного оформления заказа
├── track_order.php     # Отслеживание заказа
├── db.php              # Файл подключения к базе данных
├── get_offices.php     # AJAX-запрос для получения офисов
├── get_nearest_office.php  # AJAX-запрос для поиска ближайшего офиса
├── compare_operators.php   # AJAX-запрос для сравнения операторов
├── geocode_offices.php # Скрипт для геокодирования адресов
└── db.sql              # SQL-файл для создания базы данных
```

## Настройка API

Приложение использует следующие публичные API:

1. **OSRM Routing API** - для расчета маршрутов:
   - URL: https://router.project-osrm.org/route/v1/driving/
   - Используется в файле `compare_operators.php`

2. **Nominatim Geocoding API** - для определения координат:
   - URL: https://nominatim.openstreetmap.org/search
   - Используется в файлах `index.php` и `geocode_offices.php`

## Использование

### 1. Калькулятор доставки (index.php)
- Выберите оператора доставки из списка
- Введите адрес отправителя и получателя
- Нажмите "Выбрать ближайшее отделение" для автоматического выбора
- Укажите вес посылки и дополнительные услуги
- Нажмите "Рассчитать стоимость" для получения информации о маршруте и цене

### 2. Сравнение операторов
- После расчета для выбранного оператора автоматически рассчитываются маршруты для всех остальных операторов
- Таблица сравнения показывает расстояние, время и стоимость для каждого оператора
- Можно выбрать другой оператор для оформления заказа

### 3. Оформление заказа
- После выбора оператора и расчета стоимости перейдите на страницу оформления заказа
- Заполните контактные данные отправителя и получателя
- Подтвердите заказ

## Оффлайн-вариант (дополнительно)

Для работы без интернета:

1. Скачайте OSM-данные Беларуси:
   - https://download.geofabrik.de/europe/belarus.html
   - Выберите .osm.pbf файл

2. Установите OSRM локально:
   ```bash
   # Установка OSRM
   sudo apt-get install nodejs npm
   npm install -g osrm
   
   # Подготовка данных
   osrm-extract -p /path/to/car.lua belarus-latest.osm.pbf
   osrm-partition belarus.osrm
   osrm-customize belarus.osrm
   ```

3. Запустите локальный сервер OSRM:
   ```bash
   osrm-routed --algorithm mld belarus.osrm
   ```

4. Измените URL в файлах на ваш локальный сервер

## Тестирование

После установки:
1. Убедитесь, что главная страница открывается без ошибок
2. Проверьте, что карта загружается
3. Протестируйте расчет маршрута между двумя городами
4. Проверьте создание заказа