# Сайт доставки по Беларуси с интеграцией OSRM

Полностью переработанный курсовой проект «Сайт доставки посылок по Беларуси» с использованием реальных дорожных графов OpenStreetMap через OSRM API.

## Основные особенности

### 1. Технологии
- **Карта**: Leaflet.js с плагинами
- **Маршрутизация**: OSRM (Open Source Routing Machine) через публичный сервер
- **Геокодирование**: Nominatim API
- **База данных**: MySQL
- **Backend**: PHP
- **Frontend**: Bootstrap 5

### 2. Функционал

#### Калькулятор доставки (index.php)
- Выбор оператора доставки
- Поиск адресов через Nominatim
- Автоматический выбор ближайших отделений
- Расчет реальных маршрутов через OSRM
- Отображение маршрута на карте
- Сравнение стоимости с другими операторами

#### Оформление заказа (order_form.php)
- Подробная информация о доставке
- Карта с маршрутом
- Детализация стоимости

#### Отслеживание заказа (track_order.php)
- Карта с местоположением отправления и получения
- История статусов заказа

### 3. Структура базы данных
- `operators` - таблица операторов с тарифами
- `offices` - таблица отделений с координатами
- `orders` - таблица заказов с расстоянием, временем и стоимостью

### 4. Алгоритмы
- Использование реальных дорожных графов через OSRM
- Алгоритм поиска ближайших отделений через формулу гаверсинуса
- Расчет стоимости на основе реального расстояния и тарифов

## Установка и запуск

См. файл `INSTALL.md` для подробной инструкции по установке.

## Работа без интернета (оффлайн вариант)

Для работы без интернета:
1. Скачайте OSM-данные Беларуси: https://download.geofabrik.de/europe/belarus.html
2. Установите OSRM локально
3. Запустите локальный сервер OSRM
4. Измените URL в файлах на ваш локальный сервер

## Используемые API

### Публичные API (требуется интернет):
- OSRM Routing API: https://router.project-osrm.org/route/v1/driving/
- Nominatim Geocoding API: https://nominatim.openstreetmap.org/search

### Оффлайн-альтернативы:
- Локальный экземпляр OSRM с предварительно загруженными данными Беларуси
- Локальный Nominatim сервер (требует значительных ресурсов)

## Дополнительные скрипты

- `geocode_offices.php` - скрипт для массового геокодирования адресов отделений
- `db.sql` - SQL-дамп базы данных с начальными данными

## Безопасность и ограничения

- Все API-запросы происходят с серверной стороны для лучшей безопасности
- Использование подготовленных выражений для защиты от SQL-инъекций
- Ограничение скорости запросов к публичным API

## Масштабируемость

- Кэширование координат в базе данных
- AJAX-загрузка отделений по операторам для уменьшения нагрузки
- Оптимизированные SQL-запросы

Проект полностью готов к использованию на локальном сервере XAMPP и может быть легко адаптирован для продакшена.